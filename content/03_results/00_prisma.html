
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Prisma Diagram &#8212; Model and code sharing practices in healthcare discrete-event simulation - a systematic review</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Dataset pre-processing" href="01_preprocessing.html" />
    <link rel="prev" title="Analysis environment" href="../02_methods/05_analysis_env.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Model and code sharing practices in healthcare discrete-event simulation - a systematic review</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../01_welcome.html">
                    Overview
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../01_intro/02_license.html">
   License
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01_intro/03_funding.html">
   Funding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01_intro/04_competing_interests.html">
   Competing Interests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01_intro/01_background.html">
   Background
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01_intro/05_reproducibility.html">
   Reproducibility
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Methods
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../02_methods/01_search_strategy.html">
   Search Strategy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02_methods/02_inclusion.html">
   Study selection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02_methods/03_extraction.html">
   Data Extraction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02_methods/04_quality_audit.html">
   Best Practice Audit
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02_methods/05_analysis_env.html">
   Analysis environment
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Results - Main Review
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Prisma Diagram
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01_preprocessing.html">
   Dataset pre-processing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_sharing_hl_summary.html">
   Main summary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_article_type.html">
   Sharing by article type
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03a_reporting_guidelines.html">
   Use of reporting guidelines
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03a_year.html">
   Year of publication
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03b_software.html">
   Simulation software
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Results - Best Practice Audit
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="04_bpa_preprocessing.html">
   Preprocessing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="07a_jansson_sharing_method.html">
   Model archiving
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05_bpa_open_research.html">
   Open Research
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06_bpa_execution.html">
   Model execution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="07_bpa_summary.html">
   Overall summary
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Discussion
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../04_discussion/01_summary.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04_discussion/02_additional_observations.html">
   Additional observations on sharing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04_discussion/03_implications.html">
   Implications
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04_discussion/04_strength_limit.html">
   Strengths and Limitations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04_discussion/05_conclusions.html">
   Conclusions
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Testing
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="data_testing_bkp.html">
   Data Testing
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  PRISMA reporting checklist
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../04_prisma/01_title.html">
   Title
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04_prisma/02_abstract.html">
   Abstract
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04_prisma/03_intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04_prisma/04_methods.html">
   Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04_prisma/05_results.html">
   Results
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04_prisma/06_discussion.html">
   Discussion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04_prisma/07_other.html">
   Other information
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/TomMonks/des_sharing_lit_review/main?urlpath=lab/tree/content/03_results/00_prisma.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/TomMonks/des_sharing_lit_review"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/TomMonks/des_sharing_lit_review/issues/new?title=Issue%20on%20page%20%2Fcontent/03_results/00_prisma.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/content/03_results/00_prisma.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview-of-notebook">
   Overview of notebook
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#limitations">
   Limitations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#imports">
   1. Imports
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#graphviz-imports">
     1.1 Graphviz imports
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#standard-imports">
     1.2 Standard imports
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#imports-from-preprocessing-module">
     1.3 Imports from preprocessing module
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#constants">
   2. Constants
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#functions-to-create-diagram">
   3. Functions to create diagram
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#read-in-data">
   4. Read in data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#diagram-data-input">
   3. Diagram Data Input
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#forward-search">
   Forward Search
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#add-results-to-prisma-template-via-r-shiney-app">
   Add results to PRISMA template via R Shiney App
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#output-from-prisma-diagram-app">
   Output from PRISMA diagram app.
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Prisma Diagram</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview-of-notebook">
   Overview of notebook
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#limitations">
   Limitations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#imports">
   1. Imports
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#graphviz-imports">
     1.1 Graphviz imports
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#standard-imports">
     1.2 Standard imports
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#imports-from-preprocessing-module">
     1.3 Imports from preprocessing module
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#constants">
   2. Constants
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#functions-to-create-diagram">
   3. Functions to create diagram
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#read-in-data">
   4. Read in data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#diagram-data-input">
   3. Diagram Data Input
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#forward-search">
   Forward Search
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#add-results-to-prisma-template-via-r-shiney-app">
   Add results to PRISMA template via R Shiney App
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#output-from-prisma-diagram-app">
   Output from PRISMA diagram app.
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="prisma-diagram">
<h1>Prisma Diagram<a class="headerlink" href="#prisma-diagram" title="Permalink to this headline">#</a></h1>
<p>Here we provide a <strong>P</strong>referred <strong>R</strong>eporting <strong>I</strong>tems for <strong>S</strong>ystematic Reviews and <strong>M</strong>eta-<strong>A</strong>nalyses (PRISMA) diagram.  PRISMA aims to improve the reporting of systematic reviews.  Full details of the PRISMA statement can be found on at <a class="reference external" href="https://prisma-statement.org">https://prisma-statement.org</a></p>
<p>The flow diagram generated visualises the manuscripts returned from multiple database searches, duplicates, titles/abstracts screened in/out; and manuscripts included excluded during full text screening.</p>
<section id="overview-of-notebook">
<h2>Overview of notebook<a class="headerlink" href="#overview-of-notebook" title="Permalink to this headline">#</a></h2>
<p>This notebook uses the <code class="docutils literal notranslate"><span class="pre">graphviz</span></code> library to generate a basic flow diagram.  It is separated into four sections: imports; a function to create the flow diagram; a script to populate a <code class="docutils literal notranslate"><span class="pre">dict</span></code> with the findings from our study; and the code to run function and save the image to file.  Our flow diagram illustrates results prior to forward citation chasing.</p>
<p>The diagram we generate here is not the same layout as specified by PRISMA 2020.  To generate a compliant diagram we format our data into a template that can be uploaded to <a class="reference external" href="https://estech.shinyapps.io/prisma_flowdiagram/">https://estech.shinyapps.io/prisma_flowdiagram/</a>.</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Haddaway, N. R., Page, M. J., Pritchard, C. C., &amp; McGuinness, L. A. (2022). 
</pre></div>
</div>
</div></blockquote>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>PRISMA2020: An R package and Shiny app for producing PRISMA 2020-compliant 
flow diagrams, with interactivity for optimised digital transparency 
and Open Synthesis Campbell Systematic Reviews, 18, e1230. 
https://doi.org/10.1002/cl2.1230
</pre></div>
</div>
</section>
<section id="limitations">
<h2>Limitations<a class="headerlink" href="#limitations" title="Permalink to this headline">#</a></h2>
<p>It was not possible to completely automate our deduplication process. This was part done using our own software (stripping whitespace and punctunctation), and part using Zotero to match probably duplicates and then manually merge. Our published dataset contains all papers we <strong>attempted to retrieve</strong>.  This means we can only calculate statistics the full test screening stage of our review.</p>
</section>
<section id="imports">
<h2>1. Imports<a class="headerlink" href="#imports" title="Permalink to this headline">#</a></h2>
<section id="graphviz-imports">
<h3>1.1 Graphviz imports<a class="headerlink" href="#graphviz-imports" title="Permalink to this headline">#</a></h3>
<p>We have generated our PRSIMA diagram using <code class="docutils literal notranslate"><span class="pre">graphviz</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">graphviz</span> <span class="kn">import</span> <span class="n">Digraph</span>
<span class="kn">from</span> <span class="nn">graphviz</span> <span class="kn">import</span> <span class="n">Graph</span>
<span class="kn">import</span> <span class="nn">pydot</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="standard-imports">
<h3>1.2 Standard imports<a class="headerlink" href="#standard-imports" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="imports-from-preprocessing-module">
<h3>1.3 Imports from preprocessing module<a class="headerlink" href="#imports-from-preprocessing-module" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># function for loading full dataset</span>
<span class="kn">from</span> <span class="nn">preprocessing</span> <span class="kn">import</span> <span class="n">load_clean_dataset</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="constants">
<h2>2. Constants<a class="headerlink" href="#constants" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># studies pre forward search</span>
<span class="n">PRE_FS</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/TomMonks/&#39;</span> \
    <span class="o">+</span> <span class="s1">&#39;des_sharing_lit_review/main/data/pre_forward_search/&#39;</span> \
    <span class="o">+</span> <span class="s1">&#39;before_forward_search.zip&#39;</span>


<span class="c1"># all studies we included in stage 2</span>
<span class="n">FILE_NAME</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/TomMonks/&#39;</span> \
    <span class="o">+</span> <span class="s1">&#39;des_sharing_lit_review/main/data/share_sim_data_extract.zip&#39;</span>

<span class="c1"># pre-screnning file locations</span>
<span class="n">POST_FIX</span> <span class="o">=</span> <span class="s1">&#39;../../data/pre_screening/&#39;</span>
<span class="n">POST_FIX_STAGE1</span> <span class="o">=</span> <span class="s1">&#39;../../data/stage1/&#39;</span>
<span class="n">POST_FIX_FS</span> <span class="o">=</span> <span class="s1">&#39;../../data/forward_search/&#39;</span>
<span class="n">POST_FIX_PRE_FS</span> <span class="o">=</span> <span class="s1">&#39;../../data/pre_forward_search/&#39;</span>
<span class="n">SCOPUS</span> <span class="o">=</span> <span class="n">POST_FIX</span> <span class="o">+</span> <span class="s1">&#39;Scopus_search.zip&#39;</span>
<span class="n">PUBMED</span> <span class="o">=</span> <span class="n">POST_FIX</span> <span class="o">+</span> <span class="s1">&#39;pubmed_part.zip&#39;</span>
<span class="n">ACM</span> <span class="o">=</span> <span class="n">POST_FIX</span> <span class="o">+</span> <span class="s1">&#39;20220903_acm.zip&#39;</span>
<span class="n">WOS</span> <span class="o">=</span> <span class="n">POST_FIX</span> <span class="o">+</span> <span class="s1">&#39;20220903_wos.zip&#39;</span>
<span class="n">UNIQUE</span> <span class="o">=</span> <span class="n">POST_FIX_STAGE1</span> <span class="o">+</span> <span class="s1">&#39;unique_papers.zip&#39;</span>
<span class="n">FORWARD_SEARCH</span> <span class="o">=</span> <span class="n">POST_FIX_FS</span> <span class="o">+</span> <span class="s1">&#39;forward_search_spidercite.zip&#39;</span>
<span class="n">PRE_FS</span> <span class="o">=</span> <span class="n">POST_FIX_PRE_FS</span> <span class="o">+</span> <span class="s1">&#39;before_forward_search.zip&#39;</span>
<span class="n">FS_ASSESSED</span> <span class="o">=</span> <span class="n">POST_FIX_FS</span> <span class="o">+</span> <span class="s1">&#39;forward_search_assessed.zip&#39;</span>

<span class="c1"># for template for R shiney app to create 2020 compliant prisma diagram</span>
<span class="n">TEMPLATE_FILE</span> <span class="o">=</span> <span class="s1">&#39;prisma_template/PRISMA.csv&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="functions-to-create-diagram">
<h2>3. Functions to create diagram<a class="headerlink" href="#functions-to-create-diagram" title="Permalink to this headline">#</a></h2>
<p>We provide functions to calculate basic statistics for the dataset i.e.</p>
<ul class="simple">
<li><p>number_studies_included</p></li>
<li><p>studies_to_retrieve</p></li>
<li><p>papers_not_retrieved</p></li>
<li><p>excluded_count</p></li>
<li><p>models_with_code</p></li>
<li><p>A number of functions to return the number of records retrieved from the databases included in the study.</p></li>
</ul>
<p>And a function to create the <code class="docutils literal notranslate"><span class="pre">graphviz</span></code> based prisma diagram.</p>
<ul class="simple">
<li><p>graph_prisma</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">number_studies_included</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Return the number of studies included after screening.</span>
<span class="sd">    </span>
<span class="sd">    Params:</span>
<span class="sd">    ------</span>
<span class="sd">    df: pd.DataFrame</span>
<span class="sd">        The dataframe - expected to be the full study</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    -------</span>
<span class="sd">    int</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;study_included&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">studies_to_retrieve</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Return the number of studies to retrieve after screening</span>
<span class="sd">    </span>
<span class="sd">    Params:</span>
<span class="sd">    ------</span>
<span class="sd">    df: pd.DataFrame</span>
<span class="sd">        The dataframe - expected to be the full study</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    -------</span>
<span class="sd">    int</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">papers_not_retrieved</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Return the number of studies not retrieved.</span>
<span class="sd">    These are labelled as &#39;Full Text Not Availabe&#39;</span>
<span class="sd">    </span>
<span class="sd">    Params:</span>
<span class="sd">    ------</span>
<span class="sd">    df: pd.DataFrame</span>
<span class="sd">        The dataframe - expected to be the full study</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    -------</span>
<span class="sd">    int</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;excluded_reason&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Full Text Not Available&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">excluded_count</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">reason</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Return the number of studies excluded with a specific reason.</span>
<span class="sd">    </span>
<span class="sd">    Params:</span>
<span class="sd">    ------</span>
<span class="sd">    df: pd.DataFrame</span>
<span class="sd">        The dataframe - expected to be the full study</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    -------</span>
<span class="sd">    int</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;excluded_reason&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">reason</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">models_with_code</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Return the number of included studies that shared DES models.</span>
<span class="sd">    </span>
<span class="sd">    Params:</span>
<span class="sd">    ------</span>
<span class="sd">    df: pd.DataFrame</span>
<span class="sd">        The dataframe - expected to be the full study</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    -------</span>
<span class="sd">    int</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;study_included&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> 
                   <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;model_code_available&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">returned_from_scopus_after_dedup</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Returns the number from scopus after deduplication.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">yr</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">2023</span><span class="p">):</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">SCOPUS</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">yr</span><span class="p">)]))</span>
    <span class="k">return</span> <span class="n">total</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">returned_from_scopus_before_dedup</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Returns the number from PubMed BEFORE deduplication.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">SCOPUS</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">returned_from_pubmed_before_dedup</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Returns the number from PubMed BEFORE deduplication.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">PUBMED</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">returned_from_acm_before_dedup</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Returns the number from ACM Digital Library BEFORE deduplication.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">ACM</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">returned_from_wos_before_dedup</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Returns the number from Web of Science BEFORE deduplication.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">WOS</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">returned_unique_papers</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Returns the number from unique papers after dedup</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">UNIQUE</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">graph_prisma</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;prisma.dot&#39;</span><span class="p">,</span> <span class="n">show_subgraph</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Create PRISMA flow diagram for literature review</span>

<span class="sd">    The output is saved in a dot format file.</span>

<span class="sd">    Params:</span>
<span class="sd">    -------</span>
<span class="sd">    data: dict</span>
<span class="sd">      Dictionary of data items</span>
<span class="sd">      </span>
<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    Diagraph</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">Digraph</span><span class="p">(</span><span class="s1">&#39;PRISMA&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span>

    <span class="c1">#g.attr(label=r&quot;\n\nPrisma Flow Diagram&quot;)</span>
    <span class="c1"># need to use layout=&#39;neato&#39; to control exact position /</span>
    <span class="n">g</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;14&#39;</span><span class="p">)</span>
    
    <span class="n">common_attributes</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span><span class="s1">&#39;2cm&#39;</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">:</span><span class="s1">&#39;1cm&#39;</span><span class="p">}</span>

    <span class="n">node1_txt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Records identified from: </span><span class="se">\n</span><span class="s2">Scopus &quot;</span> \
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;(n = </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;scopus_n&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">) </span><span class="se">\n</span><span class="s2">PubMed &quot;</span> \
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;(n = </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;pubmed_n&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">) </span><span class="se">\n</span><span class="s2">ACM &quot;</span> \
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;(n = </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;acm_n&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">) </span><span class="se">\n</span><span class="s2">WoS &quot;</span> \
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;(n = </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;wos_n&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="c1"># if using neato could try pos argument e.g. pos=&#39;1,2&#39;</span>
    <span class="n">node1</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">node1_txt</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;rectangle&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">common_attributes</span><span class="p">)</span>

    <span class="n">node2_txt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Records removed:</span><span class="se">\n</span><span class="s2">&quot;</span> \
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;duplicates (n = </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_duplicates&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="n">node2</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">node2_txt</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;rectangle&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">common_attributes</span><span class="p">)</span>

    <span class="n">node3_txt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Records screened</span><span class="se">\n</span><span class="s2"> (n = </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_title_abstract&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="n">node3</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">node3_txt</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;rectangle&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">common_attributes</span><span class="p">)</span>

    <span class="n">node4_txt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Records excluded</span><span class="se">\n</span><span class="s2"> &quot;</span> \
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;(n = </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_abstracts_excluded&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="n">node4</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="n">node4_txt</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;rectangle&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">common_attributes</span><span class="p">)</span>

    <span class="n">node5_txt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Papers sought for retrieval</span><span class="se">\n</span><span class="s2"> &quot;</span> \
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;(n = </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_to_retrieve&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="n">node5</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="n">node5_txt</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;rectangle&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">common_attributes</span><span class="p">)</span>

    <span class="n">node6_txt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Papers not retrieved</span><span class="se">\n</span><span class="s2"> (n = </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_not_retrieved&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="n">node6</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="n">node6_txt</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;rectangle&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">common_attributes</span><span class="p">)</span>

    <span class="n">node6_txt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Papers assessed for eligibility</span><span class="se">\n</span><span class="s2">&quot;</span> \
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;(n = </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_assessed&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="n">node6</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="n">node6_txt</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;rectangle&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">common_attributes</span><span class="p">)</span>


    <span class="c1"># excluded reasons</span>
    <span class="n">node8_txt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Excluded at full text:</span><span class="se">\n</span><span class="s2">&quot;</span> \
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;exclude_reason1&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> (n = </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_exclude_reason1&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">)</span><span class="se">\n</span><span class="s2">&quot;</span>\
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;exclude_reason2&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> (n = </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_exclude_reason2&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">)</span><span class="se">\n</span><span class="s2">&quot;</span>\
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;exclude_reason3&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> (n = </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_exclude_reason3&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">)</span><span class="se">\n</span><span class="s2">&quot;</span>\
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;exclude_reason4&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> (n = </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_exclude_reason4&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="n">node8</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="n">node8_txt</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;rectangle&#39;</span><span class="p">)</span>
    
    <span class="n">node7_txt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Studies included in review</span><span class="se">\n</span><span class="s2">(n = </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_included&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="n">node7</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="n">node7_txt</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;rectangle&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">common_attributes</span><span class="p">)</span>

    <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">([</span><span class="s1">&#39;AB&#39;</span><span class="p">,</span> <span class="s1">&#39;AC&#39;</span><span class="p">,</span> <span class="s1">&#39;CD&#39;</span><span class="p">,</span> <span class="s1">&#39;CE&#39;</span><span class="p">,</span> <span class="s1">&#39;EF&#39;</span><span class="p">,</span> <span class="s1">&#39;EG&#39;</span><span class="p">,</span> <span class="s1">&#39;GI&#39;</span><span class="p">,</span> <span class="s1">&#39;GH&#39;</span><span class="p">])</span>


    <span class="k">if</span> <span class="n">show_subgraph</span><span class="p">:</span>
        <span class="c1"># subnodes for best practice audit</span>
        <span class="n">snode1_txt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Available models</span><span class="se">\n</span><span class="s2"> n = </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;available_models_n&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span> 
        <span class="n">snode1</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s1">&#39;H0&#39;</span><span class="p">,</span> <span class="n">snode1_txt</span><span class="p">)</span>

        <span class="n">snode2_txt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Included studies </span><span class="se">\n</span><span class="s2"> n = </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_included&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">snode2</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s1">&#39;H1&#39;</span><span class="p">,</span> <span class="n">snode2_txt</span><span class="p">)</span>

        <span class="n">snode3_txt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Percentage of models shared </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;percent&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">snode3</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="s1">&#39;H2&#39;</span><span class="p">,</span> <span class="n">snode3_txt</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">g</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;cluster_1&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
            <span class="n">c</span><span class="o">.</span><span class="n">node_attr</span><span class="p">[</span><span class="s1">&#39;style&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;filled&#39;</span>
            <span class="n">c</span><span class="o">.</span><span class="n">edges</span><span class="p">([(</span><span class="s1">&#39;H0&#39;</span><span class="p">,</span> <span class="s1">&#39;H2&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;H1&#39;</span><span class="p">,</span> <span class="s1">&#39;H2&#39;</span><span class="p">)])</span>
            <span class="n">c</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Available DES models&quot;</span><span class="p">)</span>

    <span class="n">g</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">g</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">results_in_r_shiney_format</span><span class="p">(</span><span class="n">file_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Format results so they can be uploaded to R Shiney app that creates</span>
<span class="sd">    a 2020 compliant PRISMA diagram.</span>
<span class="sd">    </span>
<span class="sd">    Params:</span>
<span class="sd">    ------</span>
<span class="sd">    file_name: str</span>
<span class="sd">        File path for prisma template compatible with app.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    pd.DataFrame</span>
<span class="sd">    </span>
<span class="sd">    References:</span>
<span class="sd">    ------</span>
<span class="sd">    Haddaway, N. R., Page, M. J., Pritchard, C. C., &amp; McGuinness, L. A. (2022). </span>
<span class="sd">    PRISMA2020: An R package and Shiny app for producing PRISMA 2020-compliant </span>
<span class="sd">    flow diagrams, with interactivity for optimised digital transparency </span>
<span class="sd">    and Open Synthesis Campbell Systematic Reviews, 18, e1230. </span>
<span class="sd">    https://doi.org/10.1002/cl2.1230</span>
<span class="sd">    </span>
<span class="sd">    https://estech.shinyapps.io/prisma_flowdiagram/</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="c1"># load template</span>
    <span class="n">shiney_template</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">TEMPLATE_FILE</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
    
    <span class="n">database_specific_results</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Scopus, </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;scopus_n&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">; &quot;</span> \
    <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;PubMed, </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;pubmed_n&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">;  &quot;</span> \
    <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;ACM, </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;acm_n&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">; WoS, </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;wos_n&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="n">dbr_excluded</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">EXCLUDED_REASON_1</span><span class="si">}</span><span class="s2">, &quot;</span> \
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">excluded_count</span><span class="p">(</span><span class="n">clean_pre_fs</span><span class="p">,</span><span class="w"> </span><span class="n">EXCLUDED_REASON_1</span><span class="p">)</span><span class="si">}</span><span class="s2">; &quot;</span> \
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">EXCLUDED_REASON_2</span><span class="si">}</span><span class="s2">, &quot;</span> \
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">excluded_count</span><span class="p">(</span><span class="n">clean_pre_fs</span><span class="p">,</span><span class="w"> </span><span class="n">EXCLUDED_REASON_2</span><span class="p">)</span><span class="si">}</span><span class="s2">; &quot;</span> \
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">EXCLUDED_REASON_3</span><span class="si">}</span><span class="s2">, &quot;</span> \
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">excluded_count</span><span class="p">(</span><span class="n">clean_pre_fs</span><span class="p">,</span><span class="w"> </span><span class="n">EXCLUDED_REASON_3</span><span class="p">)</span><span class="si">}</span><span class="s2">; &quot;</span>

    <span class="n">other_excluded</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">EXCLUDED_REASON_2</span><span class="si">}</span><span class="s2">, &quot;</span> \
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">excluded_count</span><span class="p">(</span><span class="n">clean_fs_assessed</span><span class="p">,</span><span class="w"> </span><span class="n">EXCLUDED_REASON_2</span><span class="p">)</span><span class="si">}</span><span class="s2">; &quot;</span> \
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;Preprint, &quot;</span> \
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">excluded_count</span><span class="p">(</span><span class="n">clean_fs_assessed</span><span class="p">,</span><span class="w"> </span><span class="n">EXCLUDED_REASON_4</span><span class="p">)</span><span class="si">}</span><span class="s2">;&quot;</span>
    
    <span class="c1"># database search results</span>
    <span class="n">shiney_template</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;database_specific_results&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> \
        <span class="n">database_specific_results</span>

    <span class="n">shiney_template</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;database_specific_results&#39;</span><span class="p">,</span> <span class="s1">&#39;node&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;node7&#39;</span>

    <span class="n">shiney_template</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;database_results&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;NaN&#39;</span>
    <span class="n">shiney_template</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;register_results&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;NaN&#39;</span>

    <span class="c1"># duplicates</span>
    <span class="n">shiney_template</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;duplicates&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_duplicates&#39;</span><span class="p">]</span>
    <span class="n">shiney_template</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;excluded_automatic&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;NaN&#39;</span>
    <span class="n">shiney_template</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;excluded_other&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;NaN&#39;</span>

    <span class="c1"># records screened (no. titles and abstracts) and excluded at stage 1</span>
    <span class="n">shiney_template</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;records_screened&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_title_abstract&#39;</span><span class="p">]</span>
    <span class="c1"># excluded at stage 1</span>
    <span class="n">shiney_template</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;records_excluded&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_abstracts_excluded&#39;</span><span class="p">]</span>

    <span class="c1"># papers sort for retrieval and not retrieved at stage 2 (full text)</span>
    <span class="n">shiney_template</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;dbr_sought_reports&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_to_retrieve&#39;</span><span class="p">]</span>
    <span class="n">shiney_template</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;dbr_notretrieved_reports&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> \
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_not_retrieved&#39;</span><span class="p">]</span>

    <span class="c1"># papers assessed and excluded + reasons</span>
    <span class="n">shiney_template</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;dbr_assessed&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_assessed&#39;</span><span class="p">]</span>
    <span class="n">shiney_template</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;dbr_excluded&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dbr_excluded</span>

    <span class="c1"># studies included in review</span>
    <span class="n">shiney_template</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;new_studies&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_included_after_fs&#39;</span><span class="p">]</span>
    <span class="n">shiney_template</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;new_reports&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;NaN&#39;</span>

    <span class="c1"># forward search via spidercite</span>
    <span class="n">shiney_template</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;citations_results&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_forward_search&#39;</span><span class="p">]</span>
    <span class="n">shiney_template</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;citations_results&#39;</span><span class="p">,</span> <span class="s1">&#39;boxtext&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Spidercite&#39;</span>
    <span class="n">shiney_template</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;organisation_results&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;NaN&#39;</span>
    <span class="n">shiney_template</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;website_results&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;NaN&#39;</span>

    <span class="n">shiney_template</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;other_sought_reports&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> \
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_forward_included&#39;</span><span class="p">]</span>
    <span class="n">shiney_template</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;other_notretrieved_reports&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># included excluded</span>
    <span class="n">shiney_template</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;other_assessed&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_forward_included&#39;</span><span class="p">]</span>
    <span class="n">shiney_template</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;other_excluded&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">other_excluded</span>
    
    <span class="k">return</span> <span class="n">shiney_template</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="read-in-data">
<h2>4. Read in data<a class="headerlink" href="#read-in-data" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># studies from main databases search</span>
<span class="n">clean_pre_fs</span> <span class="o">=</span> <span class="n">load_clean_dataset</span><span class="p">(</span><span class="n">PRE_FS</span><span class="p">)</span>

<span class="c1"># studies found using forward search via spidercite</span>
<span class="n">df_fs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">FORWARD_SEARCH</span><span class="p">)</span>

<span class="c1"># studies assessed after forward search screening</span>
<span class="n">clean_fs_assessed</span> <span class="o">=</span> <span class="n">load_clean_dataset</span><span class="p">(</span><span class="n">FS_ASSESSED</span><span class="p">)</span>

<span class="c1"># all students including those from forward search</span>
<span class="n">clean</span> <span class="o">=</span> <span class="n">load_clean_dataset</span><span class="p">(</span><span class="n">FILE_NAME</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="diagram-data-input">
<h2>3. Diagram Data Input<a class="headerlink" href="#diagram-data-input" title="Permalink to this headline">#</a></h2>
<p>The constant below represent values obtained from searching Scopus and Pubmed and cannot be generated from our dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># totals by database</span>
<span class="n">N_SCOPUS</span> <span class="o">=</span> <span class="n">returned_from_scopus_before_dedup</span><span class="p">()</span>
<span class="n">N_PUBMED</span> <span class="o">=</span> <span class="n">returned_from_pubmed_before_dedup</span><span class="p">()</span>
<span class="n">N_ACM</span> <span class="o">=</span> <span class="n">returned_from_acm_before_dedup</span><span class="p">()</span>
<span class="n">N_WOS</span> <span class="o">=</span> <span class="n">returned_from_wos_before_dedup</span><span class="p">()</span>
<span class="n">N_TOTAL</span> <span class="o">=</span> <span class="n">N_SCOPUS</span> <span class="o">+</span> <span class="n">N_PUBMED</span> <span class="o">+</span> <span class="n">N_ACM</span> <span class="o">+</span> <span class="n">N_WOS</span> 

<span class="c1"># no. unique papers after semi-automated dedup</span>
<span class="n">N_UNIQUE</span> <span class="o">=</span> <span class="n">returned_unique_papers</span><span class="p">()</span>

<span class="c1"># no. duplicates removed.</span>
<span class="n">DUPLICATES_REMOVED</span> <span class="o">=</span> <span class="n">N_TOTAL</span> <span class="o">-</span> <span class="n">N_UNIQUE</span>

<span class="c1"># total abstracts/titles to sceen in stage 1</span>
<span class="n">N_TITLE_ABSTRACTS</span> <span class="o">=</span> <span class="n">N_UNIQUE</span>

<span class="c1"># number excluded by stage 1 screening process</span>
<span class="n">N_ABSTRACTS_EXCLUDED</span> <span class="o">=</span> <span class="n">N_UNIQUE</span> <span class="o">-</span> <span class="n">studies_to_retrieve</span><span class="p">(</span><span class="n">clean_pre_fs</span><span class="p">)</span> 

<span class="c1"># reasons for exclusion in stage 2 (excluding not able to retrieve)</span>
<span class="n">EXCLUDED_REASON_1</span> <span class="o">=</span> <span class="s2">&quot;Not English&quot;</span>
<span class="n">EXCLUDED_REASON_2</span> <span class="o">=</span> <span class="s2">&quot;Not DES&quot;</span>
<span class="n">EXCLUDED_REASON_3</span> <span class="o">=</span> <span class="s2">&quot;Not Health&quot;</span>
<span class="n">EXCLUDED_REASON_4</span> <span class="o">=</span> <span class="s2">&quot;PRE PRINT&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#  script for prisma</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;scopus_n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">N_SCOPUS</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;pubmed_n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">N_PUBMED</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;acm_n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">N_ACM</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;wos_n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">N_WOS</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;unique_n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">N_UNIQUE</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_duplicates&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DUPLICATES_REMOVED</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_title_abstract&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">N_TITLE_ABSTRACTS</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_abstracts_excluded&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">N_ABSTRACTS_EXCLUDED</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_to_retrieve&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">studies_to_retrieve</span><span class="p">(</span><span class="n">clean_pre_fs</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_not_retrieved&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">papers_not_retrieved</span><span class="p">(</span><span class="n">clean_pre_fs</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_assessed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">studies_to_retrieve</span><span class="p">(</span><span class="n">clean_pre_fs</span><span class="p">)</span> \
    <span class="o">-</span> <span class="n">papers_not_retrieved</span><span class="p">(</span><span class="n">clean_pre_fs</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_included&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">number_studies_included</span><span class="p">(</span><span class="n">clean_pre_fs</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;exclude_reason1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EXCLUDED_REASON_1</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;exclude_reason2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EXCLUDED_REASON_2</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;exclude_reason3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EXCLUDED_REASON_3</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;exclude_reason4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EXCLUDED_REASON_4</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_exclude_reason1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">excluded_count</span><span class="p">(</span><span class="n">clean_pre_fs</span><span class="p">,</span> <span class="n">EXCLUDED_REASON_1</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_exclude_reason2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">excluded_count</span><span class="p">(</span><span class="n">clean_pre_fs</span><span class="p">,</span> <span class="n">EXCLUDED_REASON_2</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_exclude_reason3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">excluded_count</span><span class="p">(</span><span class="n">clean_pre_fs</span><span class="p">,</span> <span class="n">EXCLUDED_REASON_3</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_exclude_reason4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">excluded_count</span><span class="p">(</span><span class="n">clean_pre_fs</span><span class="p">,</span> <span class="n">EXCLUDED_REASON_4</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;available_models_n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">models_with_code</span><span class="p">(</span><span class="n">clean_pre_fs</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;percent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">models_with_code</span><span class="p">(</span><span class="n">clean_pre_fs</span><span class="p">)</span> <span class="o">/</span> \
                         <span class="n">number_studies_included</span><span class="p">(</span><span class="n">clean_pre_fs</span><span class="p">))</span> \
                        <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span> <span class="c1"># Pre - forward search</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">graph_prisma</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">show_subgraph</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">g</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/00_prisma_28_0.svg" src="../../_images/00_prisma_28_0.svg" /></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save to file</span>
<span class="p">(</span><span class="n">graph</span><span class="p">,)</span> <span class="o">=</span> <span class="n">pydot</span><span class="o">.</span><span class="n">graph_from_dot_file</span><span class="p">(</span><span class="s1">&#39;prisma.dot&#39;</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">set_dpi</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
<span class="n">graph</span><span class="o">.</span><span class="n">write_png</span><span class="p">(</span><span class="s1">&#39;prisma.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="forward-search">
<h2>Forward Search<a class="headerlink" href="#forward-search" title="Permalink to this headline">#</a></h2>
<p>The forward search was conducted using spidercite.  We uploaded the papers that contained code only.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_forward_search&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_fs</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_forward_included&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">clean</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">clean_pre_fs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_forward_search&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>430
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_forward_included&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_included_after_fs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">number_studies_included</span><span class="p">(</span><span class="n">clean</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;n_included_after_fs&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>564
</pre></div>
</div>
</div>
</div>
</section>
<section id="add-results-to-prisma-template-via-r-shiney-app">
<h2>Add results to PRISMA template via R Shiney App<a class="headerlink" href="#add-results-to-prisma-template-via-r-shiney-app" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">shiney_template</span> <span class="o">=</span> <span class="n">results_in_r_shiney_format</span><span class="p">(</span><span class="n">TEMPLATE_FILE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">shiney_template</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>node</th>
      <th>box</th>
      <th>description</th>
      <th>boxtext</th>
      <th>tooltips</th>
      <th>url</th>
      <th>n</th>
      <th>Unnamed: 8</th>
      <th>Unnamed: 9</th>
    </tr>
    <tr>
      <th>data</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>NaN</th>
      <td>node4</td>
      <td>prevstud</td>
      <td>Grey title box</td>
      <td>Previous studies</td>
      <td>Previous studies</td>
      <td>Grey title box</td>
      <td>Previous studies</td>
      <td>prevstud.html</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>previous_studies</th>
      <td>node5</td>
      <td>box1</td>
      <td>Studies included in previous version of review</td>
      <td>Studies included in previous version of review</td>
      <td>Studies included in previous version of review</td>
      <td>previous_studies.html</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save to file so can be uploaded.</span>
<span class="n">shiney_template</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;completed_prisma.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="output-from-prisma-diagram-app">
<h2>Output from PRISMA diagram app.<a class="headerlink" href="#output-from-prisma-diagram-app" title="Permalink to this headline">#</a></h2>
<p><img alt="image" src="../../_images/prisma2020.png" /></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "TomMonks/des_sharing_lit_review",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content/03_results"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../02_methods/05_analysis_env.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Analysis environment</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="01_preprocessing.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Dataset pre-processing</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Thomas Monks and Alison Harper<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>